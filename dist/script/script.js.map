{"version":3,"sources":["santa-battle.js"],"names":["santaBattle","opts","scoreList","startBtnId","resetBtnId","scoreScreen","scoreScreenSmallClass","loadViewTarget","loadView","player","level","pieces","html","hiddenClass","collectedPieces","$","init","prototype","buildPiece","obj","piece","id","class","type","copyObj","copy","constructor","attr","hasOwnProperty","bindPlayerControls","document","addEventListener","idKey","bind","e","keyCode","keyUp","keyDown","keyLeft","keyRight","movePlayer","dir","top","left","scrollHeight","target","setPlayerPos","loadPlayer","append","css","selectPiece","weightSum","i","piecesList","length","weight","index","Math","floor","random","j","loadPiece","pieceSetup","pieceLoadView","pieceTarget","removeFn","topPos","clientHeight","leftPos","clientWidth","anim","_","pieceAnim","setInterval","animLeft","offsetLeft","clearInterval","initPieces","loadedPieces","count","push","removeLoadedPiece","ele","getElementById","parentNode","removeChild","splice","initCollisionWatch","collisionWatch","collisionTest","identifyPiecePositions","positionData","closePieces","getClosePieces","result","identifyCollision","resultAction","collectPoints","addPieceToCollection","endGame","score","points","x","width","y","height","array","pos","getBoundingClientRect","preparePiecesList","smallScoreScreen","addClass","largeScoreScreen","bindLoadBtns","startBtn","startGame","resetBtn","resetGame","optsTargets","game","inlineClass","presents","total","chimney"],"mappings":"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","file":"script.js","sourcesContent":["var santaBattle = function(opts){\r\n\r\n\tthis.opts = {};\r\n\tthis.opts.scoreList = opts.scoreList;\r\n\tthis.opts.startBtnId = opts.startBtnId;\r\n\tthis.opts.resetBtnId = opts.resetBtnId;\r\n\tthis.opts.scoreScreen = opts.scoreScreen;\r\n\tthis.opts.scoreScreenSmallClass = opts.scoreScreenSmallClass;\r\n\tthis.opts.loadViewTarget = opts.loadView || false;\r\n\tthis.opts.player = opts.player || false;\r\n\tthis.opts.level = opts.level || 1;\r\n\tthis.opts.pieces = opts.pieces;\r\n\tthis.html = opts.html;\r\n\r\n\tthis.hiddenClass = \"visually-hidden\";\r\n\r\n\tthis.collectedPieces = [];\r\n\r\n\tif(this.opts.loadViewTarget && this.opts.player){\r\n\t\tthis.loadView = $(this.opts.loadViewTarget);\r\n\t\tthis.init();\r\n\t};\r\n};\r\n\r\n/* Services */\r\n\r\nsantaBattle.prototype.buildPiece = function(obj){\r\n\tvar piece = '<div';\r\n\tif(obj.id)piece += ' id=\"' + obj.id + '\"';\r\n\tif(obj.class)piece += ' class=\"' + obj.class + '\"';\r\n\tif(obj.type)piece += ' data-type=\"' + obj.type + '\"';\r\n\tpiece += '></div>';\r\n\treturn piece;\r\n};\r\n\r\nsantaBattle.prototype.copyObj = function (obj) {\r\n    var copy = obj.constructor();\r\n    for (var attr in obj) {\r\n        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];\r\n    }\r\n    return copy;\r\n};\r\n\r\n/* Controls */\r\n\r\nsantaBattle.prototype.bindPlayerControls = function(){\r\n\tdocument.addEventListener(\"keydown\", this.idKey.bind(this), false);\r\n};\r\n\r\nsantaBattle.prototype.idKey = function(e){\r\n\tswitch(e.keyCode){\r\n\t\tcase 38: // arrow up\r\n\t\tcase 87: // w\r\n\t\t\tthis.keyUp();\r\n\t\tbreak;\r\n\t\tcase 40: // down\r\n\t\tcase 83: // s\r\n\t\t\tthis.keyDown();\r\n\t\tbreak;\r\n\t\tcase 37: // left\r\n\t\tcase 65: // a\r\n\t\t\tthis.keyLeft();\r\n\t\tbreak;\r\n\t\tcase 39: // right\r\n\t\tcase 68: // d\r\n\t\t\tthis.keyRight();\r\n\t\tbreak;\r\n\t\tcase 32: // space\r\n\r\n\t\tbreak;\r\n\t};\r\n};\r\n\r\n/* Player Actions */\r\n\r\nsantaBattle.prototype.keyUp = function(){\r\n\tthis.movePlayer('up');\r\n};\r\n\r\nsantaBattle.prototype.keyDown = function(){\r\n\tthis.movePlayer('down');\r\n};\r\n\r\nsantaBattle.prototype.keyLeft = function(){\r\n\tthis.movePlayer('left');\r\n};\r\n\r\nsantaBattle.prototype.keyRight = function(){\r\n\tthis.movePlayer('right');\r\n};\r\n\r\nsantaBattle.prototype.movePlayer = function(dir){\r\n\tswitch(dir){\r\n\t\tcase 'up':\r\n\t\t\tthis.player.top -= 20;\r\n\t\tbreak;\r\n\t\tcase 'down':\r\n\t\t\tthis.player.top += 20;\r\n\t\tbreak;\r\n\t\tcase 'left':\r\n\t\t\tthis.player.left -= 20;\r\n\t\tbreak;\r\n\t\tcase 'right':\r\n\t\t\tthis.player.left += 20;\r\n\t\tbreak;\r\n\t}\r\n\r\n\tif(this.player.top < 0) this.player.top = 0;\r\n\tif(this.player.left < 0) this.player.left = 0;\r\n\r\n\tif(this.player.top > (this.loadView[0].scrollHeight - this.player.target[0].scrollHeight)) this.player.top = this.loadView[0].scrollHeight - this.player.target[0].scrollHeight;\r\n\r\n\tthis.setPlayerPos();\r\n};\r\n\r\nsantaBattle.prototype.loadPlayer = function(){\r\n\tvar html = this.buildPiece(this.opts.player);\r\n\tthis.loadView.append(html);\r\n\tthis.player = {\r\n\t\ttarget:$('#' + this.opts.player.id),\r\n\t\ttop:300,\r\n\t\tleft:0\r\n\t};\r\n\tthis.setPlayerPos();\r\n};\r\n\r\nsantaBattle.prototype.setPlayerPos = function(top, left){\r\n\tthis.player.target.css({\r\n\t\ttop:this.player.top + 'px',\r\n\t\tleft:this.player.left + 'px'\r\n\t});\r\n};\r\n\r\n/* Loading Pieces */\r\n\r\nsantaBattle.prototype.selectPiece = function (){\r\n\t// add up all the weights\r\n\tvar weightSum = 0;\r\n\tfor(var i = 0; i < this.piecesList.length; i++){\r\n\t\tweightSum+= this.piecesList[i].weight;\r\n\t};\r\n\r\n\twhile(weightSum > 0){\r\n\r\n\t\t// select random piece index\r\n\r\n\t\tvar index = Math.floor(Math.random() * Math.floor(this.piecesList.length - 1));\r\n\r\n\t\t// select random piece index\r\n\r\n\t\tweightSum -= this.piecesList[index].weight;\r\n\r\n\t\tif(weightSum > 0){\r\n\t\t\tfor(var j = 0; j < this.piecesList.length; j++){\r\n\t\t\t\tif(this.piecesList[j].weight === weightSum){\r\n\t\t\t\t\treturn this.copyObj(this.piecesList[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn false;\r\n};\r\n\r\nsantaBattle.prototype.loadPiece = function (obj){\r\n\tvar html = this.buildPiece(obj);\r\n\tthis.loadView.append(html);\r\n};\r\n\r\n/* Piece setup functions (new instance required) */\r\n\r\nsantaBattle.prototype.pieceSetup = function(opts){\r\n\r\n\tthis.piece = opts.piece;\r\n\tthis.pieceLoadView = opts.loadView;\r\n\tthis.pieceTarget = $('#' + this.piece.id);\r\n\tthis.removeFn = opts.removeFn;\r\n\r\n\tvar topPos = Math.floor(Math.random() * Math.floor(this.pieceLoadView[0].clientHeight - this.pieceTarget[0].clientHeight)),\r\n\t\tleftPos = this.pieceLoadView[0].clientWidth - this.pieceTarget[0].clientWidth;\r\n\r\n\tthis.pieceTarget.css({\r\n\t\ttop: topPos + \"px\",\r\n\t\tleft: leftPos + \"px\"\r\n\t});\r\n\r\n\tthis.anim();\r\n};\r\n\r\nsantaBattle.prototype.pieceSetup.prototype.anim = function(){\r\n\tvar _ = this;\r\n\tthis.pieceAnim = setInterval(_.animLeft.bind(_),300);\r\n};\r\n\r\nsantaBattle.prototype.pieceSetup.prototype.animLeft = function(){\r\n\tthis.pieceTarget.css({\r\n\t\tleft: this.pieceTarget[0].offsetLeft - 20 + \"px\"\r\n\t});\r\n\r\n\tif(this.pieceTarget[0].offsetLeft <= -this.pieceTarget[0].clientWidth){\r\n\t\tthis.removeFn(this.piece.id);\r\n\t\tclearInterval(this.pieceAnim);\r\n\t};\r\n};\r\n\r\n/**************************************************/\r\n\r\nsantaBattle.prototype.initPieces = function (){\r\n\tthis.loadedPieces = [];\r\n\tvar count = 0;\r\n\r\n\tvar _ = this;\r\n\r\n\tsetInterval(function(){\r\n\t\tvar piece = _.selectPiece();\r\n\t\tif(piece){\r\n\t\t\tcount += 1;\r\n\t\t\tpiece.id = 'piece' + count;\r\n\t\t\t_.loadPiece(piece);\r\n\t\t\t_.loadedPieces.push(piece);\r\n\r\n\t\t\t// Create new instance for piece setup and animations\r\n\t\t\tthis[\"activePiece\" + piece.id] = new _.pieceSetup({\r\n\t\t\t\tpiece:piece,\r\n\t\t\t\tloadView: _.loadView,\r\n\t\t\t\tremoveFn: _.removeLoadedPiece.bind(_)\r\n\t\t\t});\r\n\t\t};\r\n\t}, 2000); // random interval depending on level\r\n};\r\n\r\nsantaBattle.prototype.removeLoadedPiece = function (id){\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tif(this.loadedPieces[i].id === id){\r\n\t\t\tvar ele = document.getElementById(this.loadedPieces[i].id);\r\n\t\t\t\tele.parentNode.removeChild(ele);\r\n\t\t\tthis.loadedPieces.splice(i,1);\r\n\t\t\treturn;\r\n\t\t};\r\n\t};\r\n};\r\n\r\n\r\nsantaBattle.prototype.initCollisionWatch = function(){\r\n\tvar _ = this;\r\n\tthis.collisionWatch = setInterval(_.collisionTest.bind(_),100);\r\n};\r\n\r\n\r\nsantaBattle.prototype.collisionTest = function(){\r\n\tthis.identifyPiecePositions();\r\n\tthis.positionData(this.opts.player);\r\n\tthis.closePieces = this.getClosePieces();\r\n\tthis.result = this.identifyCollision();\r\n\tif(this.result) this.resultAction();\r\n};\r\n\r\nsantaBattle.prototype.resultAction = function(){\r\n\tswitch(this.result.type){\r\n\t\tcase \"collectable\":\r\n\t\t\tthis.removeLoadedPiece(this.result.id);\r\n\t\t\tthis.collectPoints();\r\n\t\t\tthis.addPieceToCollection();\r\n\t\tbreak;\t\r\n\t\tcase \"points\":\r\n\t\t\tthis.removeLoadedPiece(this.result.id);\r\n\t\t\tthis.collectPoints();\r\n\t\tbreak;\r\n\t\tcase \"baddie\":\r\n\t\t\tthis.endGame();\r\n\t\tbreak;\r\n\t}\r\n};\r\n\r\nsantaBattle.prototype.addPieceToCollection = function(){\r\n\tthis.collectedPieces.push(this.result);\r\n};\r\n\r\nsantaBattle.prototype.collectPoints = function(){\r\n\tthis.score += this.result.points;\r\n};\r\n\r\nsantaBattle.prototype.endGame = function(){\r\n\r\n};\r\n\r\nsantaBattle.prototype.identifyCollision = function(){\r\n\tfor(var i = 0; i < this.closePieces.length; i++){\r\n\t\tvar piece = this.closePieces[i];\r\n\r\n\t\tif(\r\n\t\t\tthis.opts.player.x + this.opts.player.width >= piece.x &&\r\n\t\t\tthis.opts.player.x < piece.x + piece.width &&\r\n\t\t\tthis.opts.player.y + this.opts.player.height > piece.y &&\r\n\t\t\tthis.opts.player.y < piece.y + piece.height\r\n\t\t){\r\n\t\t\treturn piece;\r\n\t\t};\r\n\t};\r\n\treturn false;\r\n};\r\n\r\nsantaBattle.prototype.getClosePieces = function(){\r\n\tvar array = [];\r\n\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tif(this.loadedPieces[i].x < this.opts.player.x + this.opts.player.width + 10){\r\n\t\t\tarray.push(this.copyObj(this.loadedPieces[i]));\r\n\t\t};\r\n\t};\r\n\treturn array;\r\n};\r\n\r\nsantaBattle.prototype.identifyPiecePositions = function(){\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tthis.positionData(this.loadedPieces[i]);\r\n\t};\r\n};\r\n\r\nsantaBattle.prototype.positionData = function(obj){\r\n\tvar target = $(\"#\" + obj.id),\r\n\t\tpos = target[0].getBoundingClientRect();\r\n\tobj.width = target[0].clientWidth;\r\n\tobj.height = target[0].clientHeight;\r\n\tobj.y = Math.floor(pos.top);\r\n\tobj.x = Math.floor(pos.left);\r\n};\r\n\r\nsantaBattle.prototype.preparePiecesList = function(){\r\n\tthis.piecesList = [];\r\n\tfor(var i = 0; i < this.opts.pieces.length; i++){\r\n\t\tfor(var j = 0; j < (this.opts.pieces[i].weight * 2); j++){\r\n\t\t\tthis.piecesList.push(this.copyObj(this.opts.pieces[i]));\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/* Init functions */\r\n\r\nsantaBattle.prototype.smallScoreScreen = function(){\r\n\tthis.scoreScreen.addClass(this.opts.scoreScreenSmallClass);\r\n};\r\n\r\nsantaBattle.prototype.largeScoreScreen = function(){\r\n\r\n};\r\n\r\nsantaBattle.prototype.bindLoadBtns = function(){\r\n\tvar _ = this;\r\n\t\r\n\tthis.startBtn.addEventListener('click', function(){\r\n\t\t_.smallScoreScreen();\r\n\t\t_.startGame();\r\n\t});\r\n\r\n\tthis.resetBtn.addEventListener('click', function(){\r\n\t\t_.resetGame();\r\n\t});\r\n};\r\n\r\nsantaBattle.prototype.optsTargets = function(){\r\n\tthis.scoreScreen = $(this.opts.scoreScreen);\r\n\tthis.startBtn = document.getElementById(this.opts.startBtnId);\t\r\n\tthis.resetBtn = document.getElementById(this.opts.resetBtnId);\r\n};\r\n\r\nsantaBattle.prototype.init = function(){\r\n\tthis.optsTargets();\r\n\tthis.bindLoadBtns();\r\n};\r\n\r\nsantaBattle.prototype.startGame = function(){\r\n\tthis.loadPlayer();\r\n\tthis.bindPlayerControls();\r\n\tthis.preparePiecesList();\r\n\tthis.initPieces();\r\n\tthis.initCollisionWatch();\r\n};\r\n\r\n(function(){\r\n\r\n\t$(function(){\r\n\t\tconst game = new santaBattle({\r\n\t\t\tloadView:'#santaBattle',\r\n\t\t\tscoreScreen: '.c-score-screen',\r\n\t\t\tscoreScreenSmallClass: 'c-score-screen--small',\r\n\t\t\tscoreList:{\r\n\t\t\t\ttarget:'.c-scores',\r\n\t\t\t\tinlineClass:'.c-scores--inline',\r\n\t\t\t\tlevel:'c-scores__level',\r\n\t\t\t\tpresents:'c-scores__presents',\r\n\t\t\t\ttotal:'c-scores__total'\r\n\t\t\t},\r\n\t\t\tstartBtnId: 'startBtn',\r\n\t\t\tresetBtnId:'resetBtn',\r\n\t\t\tplayer: {\r\n\t\t\t\tid:'player1',\r\n\t\t\t\tclass:'c-santa'\r\n\t\t\t},\r\n\t\t\tlevel:1,\r\n\t\t\tpieces:[\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--present\",\r\n\t\t\t\t\tpoints:10,\r\n\t\t\t\t\ttype:\"collectable\",\r\n\t\t\t\t\tweight:5\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--bonus\",\r\n\t\t\t\t\tpoints:50,\r\n\t\t\t\t\ttype:\"points\",\r\n\t\t\t\t\tweight:1\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--old-boot\",\r\n\t\t\t\t\ttype:\"baddie\",\r\n\t\t\t\t\tweight:3\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--evil-elf\",\r\n\t\t\t\t\ttype:\"baddie\",\r\n\t\t\t\t\tweight:4\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tchimney:{\r\n\t\t\t\tclass:\"c-chimney\",\r\n\t\t\t\ttype:\"catcher\",\r\n\t\t\t\tweight:1,\r\n\t\t\t\tpoints:30\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n})();"]}