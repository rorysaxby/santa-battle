{"version":3,"sources":["santa-battle.js"],"names":["santaBattle","opts","scoreList","startBtnId","resetBtnId","scoreScreen","scoreScreenSmallClass","loadViewTarget","loadView","player","level","pieces","html","hiddenClass","keysPressed","collectedPieces","$","init","prototype","buildPiece","obj","piece","id","class","type","copyObj","copy","constructor","attr","hasOwnProperty","bindPlayerControls","_","keyDown","e","keyCode","handleKeyDown","keyUp","clearInterval","document","addEventListener","keycode","direction","setInterval","movePlayer","dir","top","left","scrollHeight","target","setPlayerPos","loadPlayer","append","css","selectPiece","weightSum","i","piecesList","length","weight","index","Math","floor","random","j","loadPiece","pieceSetup","pieceLoadView","pieceTarget","removeFn","topPos","clientHeight","leftPos","clientWidth","anim","pieceAnim","animLeft","bind","offsetLeft","initPieces","loadedPieces","count","push","removeLoadedPiece","ele","getElementById","parentNode","removeChild","splice","initCollisionWatch","collisionWatch","collisionTest","identifyPiecePositions","positionData","closePieces","getClosePieces","result","identifyCollision","resultAction","collectPoints","addPieceToCollection","endGame","score","points","x","width","y","height","array","pos","getBoundingClientRect","preparePiecesList","smallScoreScreen","addClass","largeScoreScreen","bindLoadBtns","startBtn","startGame","resetBtn","resetGame","optsTargets","game","inlineClass","presents","total","chimney"],"mappings":"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","file":"script.js","sourcesContent":["var santaBattle = function(opts){\r\n\r\n\tthis.opts = {};\r\n\tthis.opts.scoreList = opts.scoreList;\r\n\tthis.opts.startBtnId = opts.startBtnId;\r\n\tthis.opts.resetBtnId = opts.resetBtnId;\r\n\tthis.opts.scoreScreen = opts.scoreScreen;\r\n\tthis.opts.scoreScreenSmallClass = opts.scoreScreenSmallClass;\r\n\tthis.opts.loadViewTarget = opts.loadView || false;\r\n\tthis.opts.player = opts.player || false;\r\n\tthis.opts.level = opts.level || 1;\r\n\tthis.opts.pieces = opts.pieces;\r\n\tthis.html = opts.html;\r\n\r\n\tthis.hiddenClass = \"visually-hidden\";\r\n\r\n\tthis.keysPressed = [];\r\n\tthis.collectedPieces = [];\r\n\r\n\tif(this.opts.loadViewTarget && this.opts.player){\r\n\t\tthis.loadView = $(this.opts.loadViewTarget);\r\n\t\tthis.init();\r\n\t};\r\n};\r\n\r\n/* Services */\r\n\r\nsantaBattle.prototype.buildPiece = function(obj){\r\n\tvar piece = '<div';\r\n\tif(obj.id)piece += ' id=\"' + obj.id + '\"';\r\n\tif(obj.class)piece += ' class=\"' + obj.class + '\"';\r\n\tif(obj.type)piece += ' data-type=\"' + obj.type + '\"';\r\n\tpiece += '></div>';\r\n\treturn piece;\r\n};\r\n\r\nsantaBattle.prototype.copyObj = function (obj) {\r\n    var copy = obj.constructor();\r\n    for (var attr in obj) {\r\n        if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];\r\n    }\r\n    return copy;\r\n};\r\n\r\n/* Controls */\r\n\r\nsantaBattle.prototype.bindPlayerControls = function(){\r\n\r\n\tvar _ = this;\r\n\r\n\tfunction keyDown(e){\r\n\t\t// requestAnimationFrame(keyDown);\r\n\r\n\t\tswitch(e.keyCode){\r\n\t\t\tcase 38: // arrow up\r\n\t\t\tcase 87: // w\r\n\t\t\t\t_.handleKeyDown(e.keyCode, 'up');\r\n\t\t\tbreak;\r\n\t\t\tcase 40: // down\r\n\t\t\tcase 83: // s\r\n\t\t\t\t_.handleKeyDown(e.keyCode, 'down');\r\n\t\t\tbreak;\r\n\t\t\tcase 37: // left\r\n\t\t\tcase 65: // a\r\n\t\t\t\t_.handleKeyDown(e.keyCode, 'left');\r\n\t\t\tbreak;\r\n\t\t\tcase 39: // right\r\n\t\t\tcase 68: // d\r\n\t\t\t\t_.handleKeyDown(e.keyCode, 'right');\r\n\t\t\tbreak;\r\n\t\t\tcase 32: // space\r\n\r\n\t\t\tbreak;\r\n\t\t};\r\n\t};\r\n\r\n\tfunction keyUp(e){\r\n\t\t_.keysPressed[e.keyCode] = false;\r\n\t\tclearInterval(_[e.keyCode]);\r\n\t};\r\n\r\n\tdocument.addEventListener(\"keydown\", keyDown, false);\r\n\tdocument.addEventListener(\"keyup\", keyUp, false);\r\n};\r\n\r\n/* Player Actions */\r\n\r\nsantaBattle.prototype.handleKeyDown = function(keycode, direction){\r\n\tvar _ = this;\r\n\r\n\tif(!this.keysPressed[keycode]){\r\n\t\tthis[keycode] = setInterval(function(){\r\n\t\t\t_.movePlayer(direction)\r\n\t\t}, 100);\r\n\t\tthis.keysPressed[keycode] = true;\r\n\t};\r\n};\r\n\r\nsantaBattle.prototype.movePlayer = function(dir){\r\n\tswitch(dir){\r\n\t\tcase 'up':\r\n\t\t\tthis.player.top -= 20;\r\n\t\tbreak;\r\n\t\tcase 'down':\r\n\t\t\tthis.player.top += 20;\r\n\t\tbreak;\r\n\t\tcase 'left':\r\n\t\t\tthis.player.left -= 20;\r\n\t\tbreak;\r\n\t\tcase 'right':\r\n\t\t\tthis.player.left += 20;\r\n\t\tbreak;\r\n\t}\r\n\r\n\tif(this.player.top < 0) this.player.top = 0;\r\n\tif(this.player.left < 0) this.player.left = 0;\r\n\r\n\tif(this.player.top > (this.loadView[0].scrollHeight - this.player.target[0].scrollHeight)) this.player.top = this.loadView[0].scrollHeight - this.player.target[0].scrollHeight;\r\n\r\n\tthis.setPlayerPos();\r\n};\r\n\r\nsantaBattle.prototype.loadPlayer = function(){\r\n\tvar html = this.buildPiece(this.opts.player);\r\n\tthis.loadView.append(html);\r\n\tthis.player = {\r\n\t\ttarget:$('#' + this.opts.player.id),\r\n\t\ttop:300,\r\n\t\tleft:0\r\n\t};\r\n\tthis.setPlayerPos();\r\n};\r\n\r\nsantaBattle.prototype.setPlayerPos = function(top, left){\r\n\tthis.player.target.css({\r\n\t\ttop:this.player.top + 'px',\r\n\t\tleft:this.player.left + 'px'\r\n\t});\r\n};\r\n\r\n/* Loading Pieces */\r\n\r\nsantaBattle.prototype.selectPiece = function (){\r\n\t// add up all the weights\r\n\tvar weightSum = 0;\r\n\tfor(var i = 0; i < this.piecesList.length; i++){\r\n\t\tweightSum+= this.piecesList[i].weight;\r\n\t};\r\n\r\n\twhile(weightSum > 0){\r\n\r\n\t\t// select random piece index\r\n\r\n\t\tvar index = Math.floor(Math.random() * Math.floor(this.piecesList.length - 1));\r\n\r\n\t\t// select random piece index\r\n\r\n\t\tweightSum -= this.piecesList[index].weight;\r\n\r\n\t\tif(weightSum > 0){\r\n\t\t\tfor(var j = 0; j < this.piecesList.length; j++){\r\n\t\t\t\tif(this.piecesList[j].weight === weightSum){\r\n\t\t\t\t\treturn this.copyObj(this.piecesList[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn false;\r\n};\r\n\r\nsantaBattle.prototype.loadPiece = function (obj){\r\n\tvar html = this.buildPiece(obj);\r\n\tthis.loadView.append(html);\r\n};\r\n\r\n/* Piece setup functions (new instance required) */\r\n\r\nsantaBattle.prototype.pieceSetup = function(opts){\r\n\r\n\tthis.piece = opts.piece;\r\n\tthis.pieceLoadView = opts.loadView;\r\n\tthis.pieceTarget = $('#' + this.piece.id);\r\n\tthis.removeFn = opts.removeFn;\r\n\r\n\tvar topPos = Math.floor(Math.random() * Math.floor(this.pieceLoadView[0].clientHeight - this.pieceTarget[0].clientHeight)),\r\n\t\tleftPos = this.pieceLoadView[0].clientWidth - this.pieceTarget[0].clientWidth;\r\n\r\n\tthis.pieceTarget.css({\r\n\t\ttop: topPos + \"px\",\r\n\t\tleft: leftPos + \"px\"\r\n\t});\r\n\r\n\tthis.anim();\r\n};\r\n\r\nsantaBattle.prototype.pieceSetup.prototype.anim = function(){\r\n\tvar _ = this;\r\n\tthis.pieceAnim = setInterval(_.animLeft.bind(_),1);\r\n};\r\n\r\nsantaBattle.prototype.pieceSetup.prototype.animLeft = function(){\r\n\tthis.pieceTarget.css({\r\n\t\tleft: this.pieceTarget[0].offsetLeft - 1 + \"px\"\r\n\t});\r\n\r\n\tif(this.pieceTarget[0].offsetLeft <= -this.pieceTarget[0].clientWidth){\r\n\t\tthis.removeFn(this.piece.id);\r\n\t\tclearInterval(this.pieceAnim);\r\n\t};\r\n};\r\n\r\n/**************************************************/\r\n\r\nsantaBattle.prototype.initPieces = function (){\r\n\tthis.loadedPieces = [];\r\n\tvar count = 0;\r\n\r\n\tvar _ = this;\r\n\r\n\tsetInterval(function(){\r\n\t\tvar piece = _.selectPiece();\r\n\t\tif(piece){\r\n\t\t\tcount += 1;\r\n\t\t\tpiece.id = 'piece' + count;\r\n\t\t\t_.loadPiece(piece);\r\n\t\t\t_.loadedPieces.push(piece);\r\n\r\n\t\t\t// Create new instance for piece setup and animations\r\n\t\t\tthis[\"activePiece\" + piece.id] = new _.pieceSetup({\r\n\t\t\t\tpiece:piece,\r\n\t\t\t\tloadView: _.loadView,\r\n\t\t\t\tremoveFn: _.removeLoadedPiece.bind(_)\r\n\t\t\t});\r\n\t\t};\r\n\t}, 500); // random interval depending on level\r\n};\r\n\r\nsantaBattle.prototype.removeLoadedPiece = function (id){\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tif(this.loadedPieces[i].id === id){\r\n\t\t\tvar ele = document.getElementById(this.loadedPieces[i].id);\r\n\t\t\t\tele.parentNode.removeChild(ele);\r\n\t\t\tthis.loadedPieces.splice(i,1);\r\n\t\t\treturn;\r\n\t\t};\r\n\t};\r\n};\r\n\r\n\r\nsantaBattle.prototype.initCollisionWatch = function(){\r\n\tvar _ = this;\r\n\tthis.collisionWatch = setInterval(_.collisionTest.bind(_),10);\r\n};\r\n\r\n\r\nsantaBattle.prototype.collisionTest = function(){\r\n\tthis.identifyPiecePositions();\r\n\tthis.positionData(this.opts.player);\r\n\tthis.closePieces = this.getClosePieces();\r\n\tthis.result = this.identifyCollision();\r\n\tif(this.result) this.resultAction();\r\n};\r\n\r\nsantaBattle.prototype.resultAction = function(){\r\n\tswitch(this.result.type){\r\n\t\tcase \"collectable\":\r\n\t\t\tthis.removeLoadedPiece(this.result.id);\r\n\t\t\tthis.collectPoints();\r\n\t\t\tthis.addPieceToCollection();\r\n\t\tbreak;\t\r\n\t\tcase \"points\":\r\n\t\t\tthis.removeLoadedPiece(this.result.id);\r\n\t\t\tthis.collectPoints();\r\n\t\tbreak;\r\n\t\tcase \"baddie\":\r\n\t\t\tthis.endGame();\r\n\t\tbreak;\r\n\t}\r\n};\r\n\r\nsantaBattle.prototype.addPieceToCollection = function(){\r\n\tthis.collectedPieces.push(this.result);\r\n};\r\n\r\nsantaBattle.prototype.collectPoints = function(){\r\n\tthis.score += this.result.points;\r\n};\r\n\r\nsantaBattle.prototype.endGame = function(){\r\n\r\n};\r\n\r\nsantaBattle.prototype.identifyCollision = function(){\r\n\tfor(var i = 0; i < this.closePieces.length; i++){\r\n\t\tvar piece = this.closePieces[i];\r\n\r\n\t\tif(\r\n\t\t\tthis.opts.player.x + this.opts.player.width >= piece.x &&\r\n\t\t\tthis.opts.player.x < piece.x + piece.width &&\r\n\t\t\tthis.opts.player.y + this.opts.player.height > piece.y &&\r\n\t\t\tthis.opts.player.y < piece.y + piece.height\r\n\t\t){\r\n\t\t\treturn piece;\r\n\t\t};\r\n\t};\r\n\treturn false;\r\n};\r\n\r\nsantaBattle.prototype.getClosePieces = function(){\r\n\tvar array = [];\r\n\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tif(this.loadedPieces[i].x < this.opts.player.x + this.opts.player.width + 10){\r\n\t\t\tarray.push(this.copyObj(this.loadedPieces[i]));\r\n\t\t};\r\n\t};\r\n\treturn array;\r\n};\r\n\r\nsantaBattle.prototype.identifyPiecePositions = function(){\r\n\tfor(var i = 0; i < this.loadedPieces.length; i++){\r\n\t\tthis.positionData(this.loadedPieces[i]);\r\n\t};\r\n};\r\n\r\nsantaBattle.prototype.positionData = function(obj){\r\n\tvar target = $(\"#\" + obj.id),\r\n\t\tpos = target[0].getBoundingClientRect();\r\n\tobj.width = target[0].clientWidth;\r\n\tobj.height = target[0].clientHeight;\r\n\tobj.y = Math.floor(pos.top);\r\n\tobj.x = Math.floor(pos.left);\r\n};\r\n\r\nsantaBattle.prototype.preparePiecesList = function(){\r\n\tthis.piecesList = [];\r\n\tfor(var i = 0; i < this.opts.pieces.length; i++){\r\n\t\tfor(var j = 0; j < (this.opts.pieces[i].weight * 2); j++){\r\n\t\t\tthis.piecesList.push(this.copyObj(this.opts.pieces[i]));\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/* Init functions */\r\n\r\nsantaBattle.prototype.smallScoreScreen = function(){\r\n\tthis.scoreScreen.addClass(this.opts.scoreScreenSmallClass);\r\n};\r\n\r\nsantaBattle.prototype.largeScoreScreen = function(){\r\n\r\n};\r\n\r\nsantaBattle.prototype.bindLoadBtns = function(){\r\n\tvar _ = this;\r\n\t\r\n\tthis.startBtn.addEventListener('click', function(){\r\n\t\t_.smallScoreScreen();\r\n\t\t_.startGame();\r\n\t});\r\n\r\n\tthis.resetBtn.addEventListener('click', function(){\r\n\t\t_.resetGame();\r\n\t});\r\n};\r\n\r\nsantaBattle.prototype.optsTargets = function(){\r\n\tthis.scoreScreen = $(this.opts.scoreScreen);\r\n\tthis.startBtn = document.getElementById(this.opts.startBtnId);\t\r\n\tthis.resetBtn = document.getElementById(this.opts.resetBtnId);\r\n};\r\n\r\nsantaBattle.prototype.init = function(){\r\n\tthis.optsTargets();\r\n\tthis.bindLoadBtns();\r\n};\r\n\r\nsantaBattle.prototype.startGame = function(){\r\n\tthis.loadPlayer();\r\n\tthis.bindPlayerControls();\r\n\tthis.preparePiecesList();\r\n\tthis.initPieces();\r\n\tthis.initCollisionWatch();\r\n};\r\n\r\n(function(){\r\n\r\n\t$(function(){\r\n\t\tconst game = new santaBattle({\r\n\t\t\tloadView:'#santaBattle',\r\n\t\t\tscoreScreen: '.c-score-screen',\r\n\t\t\tscoreScreenSmallClass: 'c-score-screen--small',\r\n\t\t\tscoreList:{\r\n\t\t\t\ttarget:'.c-scores',\r\n\t\t\t\tinlineClass:'.c-scores--inline',\r\n\t\t\t\tlevel:'c-scores__level',\r\n\t\t\t\tpresents:'c-scores__presents',\r\n\t\t\t\ttotal:'c-scores__total'\r\n\t\t\t},\r\n\t\t\tstartBtnId: 'startBtn',\r\n\t\t\tresetBtnId:'resetBtn',\r\n\t\t\tplayer: {\r\n\t\t\t\tid:'player1',\r\n\t\t\t\tclass:'c-santa'\r\n\t\t\t},\r\n\t\t\tlevel:1,\r\n\t\t\tpieces:[\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--present\",\r\n\t\t\t\t\tpoints:10,\r\n\t\t\t\t\ttype:\"collectable\",\r\n\t\t\t\t\tweight:5\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--bonus\",\r\n\t\t\t\t\tpoints:50,\r\n\t\t\t\t\ttype:\"points\",\r\n\t\t\t\t\tweight:1\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--old-boot\",\r\n\t\t\t\t\ttype:\"baddie\",\r\n\t\t\t\t\tweight:3\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclass:\"c-piece c-piece--evil-elf\",\r\n\t\t\t\t\ttype:\"baddie\",\r\n\t\t\t\t\tweight:4\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tchimney:{\r\n\t\t\t\tclass:\"c-chimney\",\r\n\t\t\t\ttype:\"catcher\",\r\n\t\t\t\tweight:1,\r\n\t\t\t\tpoints:30\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n})();"]}